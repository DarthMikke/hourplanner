(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{15:function(e,t,n){"use strict";n.r(t);var r,o,i=n(1),a=n.n(i),l=n(9),s=n.n(l),c=n(3),d=n(4),u=n(6),h=n(5),f=n(2),p=["title","titleId"];function m(){return m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m.apply(this,arguments)}function v(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function b(e,t){var n=e.title,a=e.titleId,l=v(e,p);return i.createElement("svg",m({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",className:"bi bi-chevron-double-left",viewBox:"0 0 16 16",ref:t,"aria-labelledby":a},l),n?i.createElement("title",{id:a},n):null,r||(r=i.createElement("path",{fillRule:"evenodd",d:"M8.354 1.646a.5.5 0 0 1 0 .708L2.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"})),o||(o=i.createElement("path",{fillRule:"evenodd",d:"M12.354 1.646a.5.5 0 0 1 0 .708L6.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"})))}var j,O=i.forwardRef(b),y=(n.p,["title","titleId"]);function g(){return g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},g.apply(this,arguments)}function w(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function x(e,t){var n=e.title,r=e.titleId,o=w(e,y);return i.createElement("svg",g({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",className:"bi bi-chevron-left",viewBox:"0 0 16 16",ref:t,"aria-labelledby":r},o),n?i.createElement("title",{id:r},n):null,j||(j=i.createElement("path",{fillRule:"evenodd",d:"M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"})))}var k,S=i.forwardRef(x),I=(n.p,["title","titleId"]);function D(){return D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},D.apply(this,arguments)}function _(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function C(e,t){var n=e.title,r=e.titleId,o=_(e,I);return i.createElement("svg",D({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",className:"bi bi-chevron-right",viewBox:"0 0 16 16",ref:t,"aria-labelledby":r},o),n?i.createElement("title",{id:r},n):null,k||(k=i.createElement("path",{fillRule:"evenodd",d:"M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"})))}var E,N,P=i.forwardRef(C),F=(n.p,["title","titleId"]);function M(){return M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},M.apply(this,arguments)}function T(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function R(e,t){var n=e.title,r=e.titleId,o=T(e,F);return i.createElement("svg",M({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",className:"bi bi-chevron-double-right",viewBox:"0 0 16 16",ref:t,"aria-labelledby":r},o),n?i.createElement("title",{id:r},n):null,E||(E=i.createElement("path",{fillRule:"evenodd",d:"M3.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L9.293 8 3.646 2.354a.5.5 0 0 1 0-.708z"})),N||(N=i.createElement("path",{fillRule:"evenodd",d:"M7.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L13.293 8 7.646 2.354a.5.5 0 0 1 0-.708z"})))}var z,L,B=i.forwardRef(R),W=(n.p,n(0)),A=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,e)).f=null;var o=new Date(e.from),i=new Date(e.to);return r.state={from:o,to:i},r.f=Intl.DateTimeFormat("nn",{day:"numeric",month:"numeric"}),r.prevWeek=r.prevWeek.bind(Object(f.a)(r)),r.prevDay=r.prevDay.bind(Object(f.a)(r)),r.nextDay=r.nextDay.bind(Object(f.a)(r)),r.nextWeek=r.nextWeek.bind(Object(f.a)(r)),r.offset=r.offset.bind(Object(f.a)(r)),r}return Object(d.a)(n,[{key:"offset",value:function(e){var t=new Date(1e3*(this.state.from/1e3+86400*e)),n=new Date(1e3*(this.state.to/1e3+86400*e));this.setState({from:t,to:n}),this.props.completion(t,n)}},{key:"prevWeek",value:function(){this.offset(-7)}},{key:"prevDay",value:function(){this.offset(-1)}},{key:"nextDay",value:function(){this.offset(1)}},{key:"nextWeek",value:function(){this.offset(7)}},{key:"render",value:function(){return Object(W.jsxs)("div",{className:"btn-group",children:[Object(W.jsx)("button",{type:"button",className:"btn btn-primary",onClick:this.prevWeek,children:Object(W.jsx)(O,{})}),Object(W.jsx)("button",{type:"button",className:"btn btn-primary",onClick:this.prevDay,children:Object(W.jsx)(S,{})}),Object(W.jsxs)("button",{type:"button",className:"btn btn-outline-primary",children:[this.f.format(this.state.from),"\u2013",this.f.format(this.state.to)]}),Object(W.jsx)("button",{type:"button",className:"btn btn-primary",onClick:this.nextDay,children:Object(W.jsx)(P,{})}),Object(W.jsx)("button",{type:"button",className:"btn btn-primary",onClick:this.nextWeek,children:Object(W.jsx)(B,{})})]})}}]),n}(i.Component),V=["title","titleId"];function J(){return J=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},J.apply(this,arguments)}function Y(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function q(e,t){var n=e.title,r=e.titleId,o=Y(e,V);return i.createElement("svg",J({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",className:"bi bi-plus-circle",viewBox:"0 0 16 16",ref:t,"aria-labelledby":r},o),n?i.createElement("title",{id:r},n):null,z||(z=i.createElement("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"})),L||(L=i.createElement("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})))}var H,G=i.forwardRef(q),K=(n.p,n.p+"static/media/pencil.372bf1c0.svg"),Q=n.p+"static/media/trash.43abd16f.svg",U=["title","titleId"];function X(){return X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},X.apply(this,arguments)}function Z(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function $(e,t){var n=e.title,r=e.titleId,o=Z(e,U);return i.createElement("svg",X({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",className:"bi bi-exclamation-triangle-fill",viewBox:"0 0 16 16",ref:t,"aria-labelledby":r},o),n?i.createElement("title",{id:r},n):null,H||(H=i.createElement("path",{d:"M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"})))}var ee,te,ne=i.forwardRef($),re=(n.p,["title","titleId"]);function oe(){return oe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oe.apply(this,arguments)}function ie(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function ae(e,t){var n=e.title,r=e.titleId,o=ie(e,re);return i.createElement("svg",oe({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",className:"bi bi-cloud-arrow-up",viewBox:"0 0 16 16",ref:t,"aria-labelledby":r},o),n?i.createElement("title",{id:r},n):null,ee||(ee=i.createElement("path",{fillRule:"evenodd",d:"M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z"})),te||(te=i.createElement("path",{d:"M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"})))}var le=i.forwardRef(ae);n.p;function se(e){var t="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===t.length)return t.pop().split(";").shift()}var ce=n.p+"static/media/check2-circle.001ff82b.svg",de=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,e)).f=null;var o="locale"in e?e.locale:"nn";return r.f=Intl.DateTimeFormat(o,{hour:"numeric",minute:"numeric"}),r.state={from:e.from,to:e.to,error:!1,validated:void 0},r.handleInputFrom=r.handleInputFrom.bind(Object(f.a)(r)),r.handleInputTo=r.handleInputTo.bind(Object(f.a)(r)),r.save=r.save.bind(Object(f.a)(r)),r.delete=r.delete.bind(Object(f.a)(r)),r}return Object(d.a)(n,[{key:"handleInputFrom",value:function(e){this.setState({from:e.target.value})}},{key:"handleInputTo",value:function(e){this.setState({to:e.target.value})}},{key:"validate",value:function(e){String(e).length<5&&(e="0"+e);var t=new Date("1970-01-01T".concat(e,":00"));return!isNaN(t/1e3)}},{key:"save",value:function(){var e=(this.validate(this.state.from)?1:0)+(this.validate(this.state.to)?2:0);this.setState({validated:e}),e<3?this.setState({error:!0}):this.props.completion(this.state.from,this.state.to)}},{key:"delete",value:function(){this.props.deleteCompletion()}},{key:"render",value:function(){var e=this,t=[1,2].map((function(t){var n=null;return n=void 0===e.state.validated?"form-control":"form-control "+((t&e.state.validated)===t?"is-valid":"is-invalid"),console.log(n),n}));return Object(W.jsxs)("form",{children:[Object(W.jsx)("input",{className:t[0],type:"text",style:{width:"4em"},value:this.state.from,onChange:this.handleInputFrom},"input-from"),Object(W.jsx)("br",{},"input-break-1"),Object(W.jsx)("input",{className:t[1],type:"text",style:{width:"4em"},value:this.state.to,onChange:this.handleInputTo}),Object(W.jsx)("br",{},"input-break-2"),Object(W.jsx)("img",{src:Q,onClick:function(){e.delete()}}),Object(W.jsx)("img",{src:ce,onClick:function(){e.save()}},"save-icon")]})}}]),n}(i.Component),ue=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,e)).viewmodel=null,r.f=null,e.viewmodels.length>=1&&(console.log("Viewmodels on ".concat(e.viewmodels[0].from.toISOString())),console.log(e.viewmodels));var o="locale"in e?e.locale:"nn";return r.f=Intl.DateTimeFormat(o,{hour:"numeric",minute:"numeric"}),r.state={editing:!1,error:!1,waiting:!1,waiting_to_delete:!1,showButtons:!1,viewmodels:e.viewmodels,from:void 0,to:void 0},r.create=r.create.bind(Object(f.a)(r)),r.edit=r.edit.bind(Object(f.a)(r)),r.save=r.save.bind(Object(f.a)(r)),r.delete=r.delete.bind(Object(f.a)(r)),r}return Object(d.a)(n,[{key:"create",value:function(){var e=new Date(1e3*(this.props.day/1e3+28800)),t=new Date(1e3*(this.props.day/1e3+57600)),n=this.state.viewmodels;n.push({employee:this.props.employee_id,division:this.props.division.division_id,schedule_id:-1,from:e,to:t,duration:(t-e)/1e3/3600}),this.setState({editing:-1,viewmodels:n})}},{key:"edit",value:function(e){console.log("Editing ".concat(e,".")),this.setState({editing:e,from:this.f.format(this.state.viewmodels.filter((function(t){return t.schedule_id===e}))[0].from),to:this.f.format(this.state.viewmodels.filter((function(t){return t.schedule_id===e}))[0].to)})}},{key:"save",value:function(e,t){var n,r,o=this,i=this.state.editing,a=this.state.viewmodels.findIndex((function(e){return e.schedule_id===i}));n=new Date(this.props.day.getFullYear(),this.props.day.getMonth(),this.props.day.getDate(),parseInt(e.substr(0,e.indexOf(":"))),parseInt(e.substr(e.indexOf(":")+1))),r=new Date(this.props.day.getFullYear(),this.props.day.getMonth(),this.props.day.getDate(),parseInt(t.substr(0,t.indexOf(":"))),parseInt(t.substr(t.indexOf(":")+1))),console.log("".concat(n,"\u2013").concat(r));var l=this.state.viewmodels;console.log(i,a,l),l[a].from=n,l[a].to=r,this.setState({waiting:i,editing:!1,viewmodels:l});var s=new FormData,c={schedule_id:l[a].schedule_id,employee:l[a].employee,division:l[a].division,from:l[a].from.toISOString(),to:l[a].to.toISOString(),duration:l[a].duration};for(var d in console.log(c),c)"schedule_id"==d&&-1===i||(console.log(d,c[d]),s.append(d,c[d]));var u=-1===i?"api/schedules/create":"api/schedules/update";console.log("Sender f\xf8respurnad til ".concat(u)),fetch(u,{method:"POST",body:s,headers:{"x-csrftoken":se("csrftoken")}}).then((function(e){return e.ok?(console.log(e),e.json()):(console.log("Request answered with status ".concat(e.status,".")),{error:e.status})})).then((function(e){if(console.log(e),void 0===e.error){console.log("Received a response (probably a working hours record) from the server:");var t="localhost"===window.location.hostname?3e3:1e3;console.log("Waiting ".concat(t," ms\u2026")),setTimeout((function(){var t={schedule_id:o.state.viewmodels[a].schedule_id,employee:o.state.viewmodels[a].employee,division:o.state.viewmodels[a].division,from:o.state.viewmodels[a].from,to:o.state.viewmodels[a].to,duration:o.state.viewmodels[a].duration},n=o.state.viewmodels;n[a].schedule_id=e.schedule_id,n[a].from=new Date(e.from),n[a].to=new Date(e.to),o.setState({waiting:!1,viewmodels:n}),o.props.completion(t,n[a])}),t)}else o.setState({waiting:!1,error:i})}))}},{key:"delete",value:function(){var e=this,t=this.state.editing,n=this.state.viewmodels.findIndex((function(e){return e.schedule_id===t}));this.setState({waiting_to_delete:t,editing:!1});var r=new FormData;for(var o in this.state.viewmodels[n])r.append(o,this.state.viewmodels[n][o]);var i="api/schedules/delete";console.log("Sender f\xf8respurnad til ".concat(i)),fetch(i,{method:"POST",body:r,headers:{"x-csrftoken":se("csrftoken")}}).then((function(n){return n.ok||e.setState({error:t,waiting_to_delete:!1}),console.trace(),n.json()})).catch((function(n){return e.setState({error:t,waiting_to_delete:!1}),console.trace(),{error:n}})).then((function(t){if(void 0===t.error){var r=e.state.viewmodels.splice(n,1);e.setState({waiting_to_delete:!1}),e.props.completion(r,null),console.trace()}}))}},{key:"render",value:function(){var e=this,t=this.state.viewmodels.map((function(t){console.log(t);var n=null;if(e.state.editing===t.schedule_id)n=[Object(W.jsx)(de,{from:e.state.from,to:e.state.to,completion:function(t,n){e.save(t,n)},deleteCompletion:function(){e.delete()}},"single-schedule-".concat(e.props.day))];else{var r=!1,o=null;e.state.error===t.schedule_id?(o=Object(W.jsx)(ne,{fill:"black"},"error-".concat(t.schedule_id)),r=!0,console.log("".concat(t.schedule_id," st\xf8tte p\xe5 ein feil."))):e.state.waiting===t.schedule_id&&(o=Object(W.jsx)(le,{fill:"black"},"waiting-".concat(t.schedule_id)),r=!0,console.log("".concat(t.schedule_id," ventar p\xe5 respons.")));var i=r?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("br",{}),Object(W.jsx)("span",{className:"badge",children:o})]}):null;n=Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)("span",{children:["fr\xe5 ",e.f.format(t.from)]}),e.state.showButtons?Object(W.jsx)("span",{className:"badge",children:Object(W.jsx)("img",{onClick:function(){e.edit(t.schedule_id)},src:K})}):null,Object(W.jsx)("br",{}),Object(W.jsxs)("span",{children:["til ",e.f.format(t.to)]}),i]})}var a=["border-bottom","text-center","align-items-center","py-2"];return a.push(e.state.error===t.schedule_id||e.state.waiting_to_delete===t.schedule_id?"waiting-for-deletion":null),Object(W.jsx)("div",{className:a.join(" "),children:n})})),n=Object(W.jsx)("button",{type:"button",onClick:function(){return e.create()},className:"rounded-pill btn btn-secondary",children:Object(W.jsx)(G,{})}),r=["hiding-button","d-flex","justify-content-center","align-items-center"];return r.push(0===t.length?"p-3":"p-1"),r.push(this.state.showButtons?null:"hide"),t.push(Object(W.jsx)("div",{className:r.join(" "),children:n})),Object(W.jsx)("td",{style:{width:"8.5em"},onMouseEnter:function(){!1===e.state.editing&&e.setState({showButtons:!0})},onMouseLeave:function(){!1===e.state.editing&&e.setState({showButtons:!1})},children:Object(W.jsx)("div",{className:"flex-row border rounded-2 p-0",children:t})},"employee-row-cell-".concat(this.state.viewmodels.length>0?this.state.viewmodels[0].from:Math.floor(1e3*Math.random())))}}]),n}(i.Component),he=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,e)).f=null;var o="locale"in e?e.locale:"nn";return r.f=Intl.DateTimeFormat(o,{weekday:"short",day:"numeric",month:"numeric"}),r}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return this.props.dates.map((function(t){return Object(W.jsx)("th",{style:{width:"9em"},children:e.f.format(t)},t.toISOString())}))}}]),n}(i.Component),fe=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return Object(d.a)(n,[{key:"render",value:function(){var e=this,t=0,n=this.props.dates.map((function(n){var r=e.props.plannedWorkhours.map((function(e){var t=new Date(e.from),n=new Date(e.to);return{employee:e.employee,schedule_id:e.schedule_id,division:e.division,from:t,to:n,duration:(n-t)/1e3/3600}})).filter((function(r){var o=n<=r.from,i=r.from<new Date(1e3*(n/1e3+86400)),a=r.employee===e.props.employee.employee_id,l=o&&i&&a;return l&&(t+=r.duration),l}));return console.log("Scheduled hours for ".concat(e.props.employee.name," on ").concat(n.toISOString(),":")),console.log(r),Object(W.jsx)(ue,{day:n,employee_id:e.props.employee.employee_id,division:e.props.division,viewmodels:r,completion:function(t,n){e.props.completion(t,n)}},n)}));return t=0==t?Object(W.jsx)("td",{className:"text-muted",children:"\u2013"}):Object(W.jsxs)("td",{children:[t," t"]}),Object(W.jsxs)("tr",{children:[Object(W.jsx)("th",{children:this.props.employee.name}),n,t]},this.props.employee.employee_id)}}]),n}(i.Component),pe=(n(8),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var r;Object(c.a)(this,n),console.log("WeeklyView.constructor()"),(r=t.call(this,e)).f=Intl.DateTimeFormat("nn",{weekday:"short",day:"numeric",month:"numeric"}),r.f2=Intl.DateTimeFormat("nn",{hour:"numeric",minute:"numeric"}),r.f3=Intl.DateTimeFormat("nn",{day:"numeric",month:"numeric"}),r.f4=Intl.DateTimeFormat("nn",{year:"numeric",month:"2-digit",day:"2-digit"});var o=r.f4.formatToParts(new Date),i=o.find((function(e){return"year"===e.type})).value,a=o.find((function(e){return"month"===e.type})).value,l=o.find((function(e){return"day"===e.type})).value,s=new Date("".concat(i,"-").concat(a,"-").concat(l)),d=new Date(1e3*(s/1e3+518400));return r.state={loaded:!1,from:s,to:d,company:void 0,divisions:[],dates:[],employees:[],schedules:[],staff:!1},r.loadData=r.loadData.bind(Object(f.a)(r)),r.updateSchedule=r.updateSchedule.bind(Object(f.a)(r)),r}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this;fetch("api/me").then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({staff:t.employee.staff,company:t.company.company_id}),e.loadData(e.state.from,e.state.to)}))}},{key:"loadData",value:function(e,t){for(var n=this,r=new Date(e),o=new Date(t),i=1e3*Math.floor(r/1e3),a=[],l=0;l<=6;l++)a.push(new Date(i+24*l*3600*1e3));console.log("Dates: ".concat(a));var s=void 0==this.state.company?null:this.state.company;fetch("api/schedules/list?company=".concat(s,"&from=").concat(r.toISOString(),"&to=").concat(o.toISOString())).then((function(e){return e.json()})).then((function(r){return console.log(r),n.setState({from:e,to:t,dates:a,divisions:r.divisions,schedules:r.schedules,employees:r.employees,loaded:!0}),!0}))}},{key:"updateSchedule",value:function(e,t){console.log("Changing from",e,"to",t);var n=this.state.schedules;if(-1===e.schedule_id)n.push(t);else{var r=this.state.schedules.findIndex((function(t){return t.schedule_id===e.schedule_id}));if(console.log("Found schedule with id ".concat(e.schedule_id," at index ").concat(r,".")),null===t.schedule_id)n.splice(r,1);else{var o=this.state.schedules.findIndex((function(t){return t.schedule_id===e.schedule_id})),i=(this.state.schedules[o],this.state.schedules[o]);console.trace(),console.log(e.schedule_id,t,i),i.schedule_id=t.schedule_id,i.from=t.from,i.to=t.to,n[o]=i}}this.setState({schedules:n})}},{key:"render",value:function(){var e=this,t=(this.f3.format(this.state.from),this.f3.format(this.state.to),Object(W.jsx)(he,{dates:this.state.dates})),n=this.state.employees.map((function(t){return Object(W.jsx)(fe,{dates:e.state.dates,division:e.state.divisions[0],plannedWorkhours:e.state.schedules,employee:t,completion:function(t,n){e.updateSchedule(t,n)}})})),r=this.state.dates.map((function(t){var n=new Date(1e3*(t/1e3+86400)),r=e.state.schedules.map((function(e){var t=new Date(e.from),n=new Date(e.to);return{from:t,to:n,duration:(n-t)/1e3/3600}})).filter((function(e){var r=new Date(e.from);return t<=r&&r<n})).map((function(e){return e.duration})).reduce((function(e,t){return e+t}),0);return 0==r?Object(W.jsx)("td",{className:"text-muted",children:"\u2013"}):Object(W.jsxs)("td",{children:[r," t"]})}));return this.state.loaded?Object(W.jsxs)("div",{className:"WeeklyView",children:[Object(W.jsx)("h1",{children:this.state.company.name}),Object(W.jsx)(A,{from:this.state.from,to:this.state.to,completion:function(t,n){return e.loadData(t,n)}}),Object(W.jsx)("div",{className:"table-responsive",children:Object(W.jsxs)("table",{className:"table small",children:[Object(W.jsx)("thead",{children:Object(W.jsxs)("tr",{children:[Object(W.jsx)("th",{scope:"col",children:"Tilsett"}),t,Object(W.jsx)("th",{scope:"col",children:"Totalt"})]})}),Object(W.jsx)("tbody",{children:n}),Object(W.jsx)("tfoot",{children:Object(W.jsxs)("tr",{children:[Object(W.jsx)("td",{}),r,Object(W.jsx)("td",{})]})})]})},"table")]}):Object(W.jsx)("div",{className:"WeeklyView",children:"Loading..."})}}]),n}(i.Component)),me=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={view:"weekly"},r}return Object(d.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return"weekly"===this.state.view?Object(W.jsx)(pe,{}):Object(W.jsx)("p",{children:"An error has occured."})}}]),n}(i.Component),ve=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,16)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),r(e),o(e),i(e),a(e)}))};s.a.render(Object(W.jsx)(a.a.StrictMode,{children:Object(W.jsx)(me,{})}),document.getElementById("root")),ve()},8:function(e,t,n){}},[[15,1,2]]]);
//# sourceMappingURL=main.39cc0333.chunk.js.map